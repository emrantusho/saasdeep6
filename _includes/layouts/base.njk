<!DOCTYPE html>
<html lang="en" x-data="{darkMode: localStorage.getItem('darkMode') === 'true', menuOpen: false, activePage: null, iframeLoading: true}" x-init="$watch('darkMode', val => localStorage.setItem('darkMode', val))" :class="{ 'dark': darkMode }">
<head>
    <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ settings.logoText }} | Showcase</title>
    <link rel="preconnect" href="https://fonts.googleapis.com"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>[x-cloak] { display: none !important; }</style>
</head>
<body class="bg-gray-200 dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-300 font-sans" x-data="sidebar()">
    <!-- ===== Navigation Overlay ===== -->
    <div x-show="menuOpen" x-cloak class="fixed inset-0 bg-gray-200 dark:bg-gray-800 z-50 p-6 flex flex-col" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 transform -translate-x-full" x-transition:enter-end="opacity-100 transform translate-x-0" x-transition:leave="transition ease-in duration-300" x-transition:leave-start="opacity-100 transform translate-x-0" x-transition:leave-end="opacity-0 transform -translate-x-full">
        <div class="flex justify-between items-center mb-4">
          <img src="{{ settings.logoImage }}" alt="{{ settings.logoText }} Logo" class="h-10 w-auto">
          <button @click="menuOpen = false" class="text-gray-600 dark:text-gray-400 hover:text-blue-500 dark:hover:text-blue-400">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
          </button>
        </div>
        <div class="relative mt-4">
            <input type="text" x-model.debounce.300ms="searchQuery" placeholder="Search pages..." class="w-full px-4 py-3 rounded-lg bg-gray-200 dark:bg-gray-900 border-none focus:ring-2 focus:ring-blue-500 text-gray-800 dark:text-gray-200 shadow-[inset_5px_5px_10px_#d0d0d0,inset_-5px_-5px_10px_#ffffff] dark:shadow-[inset_5px_5px_10px_#1c1c1c,inset_-5px_-5px_10px_#2a2a2a]">
        </div>
        <nav class="mt-4 flex-grow overflow-y-auto pr-2">
            <ul class="space-y-2">
                <template x-for="page in filteredPages" :key="page.embedUrl">
                    <li>
                        <a :href="page.embedUrl" @click.prevent="activePage = page; iframeLoading = true; menuOpen = false" class="block w-full text-left px-4 py-3 rounded-lg text-gray-700 dark:text-gray-300 transition-all duration-200 font-medium hover:bg-gray-300 dark:hover:bg-gray-700" :class="{ 'font-semibold text-blue-600 dark:text-blue-400 bg-gray-300 dark:bg-gray-700': activePage && activePage.embedUrl === page.embedUrl }">
                            <span x-text="page.title"></span>
                        </a>
                    </li>
                </template>
                <li x-show="filteredPages.length === 0" class="px-4 py-3 text-gray-500">No pages found.</li>
            </ul>
        </nav>
        <div class="mt-6 pt-6 border-t border-gray-300 dark:border-gray-700">
             <button @click="darkMode = !darkMode" class="w-full flex items-center justify-center gap-x-2 px-4 py-3 rounded-lg font-semibold bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 transition-colors duration-150">
                <span x-show="!darkMode">üåô</span><span x-show="darkMode">‚òÄÔ∏è</span>
                <span x-text="darkMode ? 'Light Mode' : 'Dark Mode'"></span>
            </button>
        </div>
    </div>

    <!-- ===== Main Content Area ===== -->
    <main class="w-screen h-screen">
        <div class="w-full h-full flex items-center justify-center text-center p-4 bg-gray-200 dark:bg-gray-900" x-show="!activePage" x-cloak>
            <h2 class="text-3xl md:text-4xl font-bold text-gray-700 dark:text-gray-300">
                Welcome to SaasDeep Demos.<br class="block md:hidden"> Click the menu to begin.
            </h2>
        </div>

        <!-- NEW BROWSER-LIKE IFRAME SECTION -->
        <div class="w-full h-full p-4 sm:p-8 md:p-12 bg-gray-200 dark:bg-gray-900" x-show="activePage" x-cloak>
            <div class="w-full h-full bg-white dark:bg-gray-800 rounded-lg shadow-2xl flex flex-col">
                <!-- Browser Control Bar -->
                <div class="flex items-center p-2 border-b border-gray-200 dark:border-gray-700 bg-gray-100 dark:bg-gray-700 rounded-t-lg">
                    <div class="flex space-x-2">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    </div>
                    <div class="flex items-center pl-4 space-x-1">
                        <button @click=".iframe.contentWindow.history.back()" class="p-1 rounded text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-600"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg></button>
                        <button @click=".iframe.contentWindow.history.forward()" class="p-1 rounded text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-600"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg></button>
                        <button @click=".iframe.contentWindow.location.reload()" class="p-1 rounded text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-600"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h5M20 20v-5h-5M20 4l-4 4M4 20l4-4" /></svg></button>
                    </div>
                    <div class="flex-1 text-center text-sm text-gray-600 dark:text-gray-400 bg-white dark:bg-gray-800 rounded-md px-3 py-1 mx-2 truncate" x-text="activePage ? activePage.embedUrl : ''"></div>
                    <a :href="activePage ? activePage.embedUrl : '#'" target="_blank" class="p-1 rounded text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-600"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg></a>
                </div>
                <!-- Iframe and Loader Container -->
                <div class="flex-1 relative bg-gray-100 dark:bg-gray-700 rounded-b-lg">
                    <div x-show="iframeLoading" class="absolute inset-0 flex items-center justify-center"><svg class="animate-spin h-8 w-8 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div>
                    <iframe x-ref="iframe" @load="iframeLoading = false" :src="activePage ? activePage.embedUrl : ''" class="w-full h-full border-none rounded-b-lg" frameborder="0"></iframe>
                </div>
            </div>
        </div>
    </main>

    <!-- ===== Open Menu Button ===== -->
    <div class="fixed top-5 left-5 z-40">
        <button x-show="!menuOpen" @click="menuOpen = true" x-cloak class="block p-4 bg-white/70 dark:bg-black/50 backdrop-blur-sm font-bold rounded-lg shadow-lg dark:shadow-black/50 transition-transform hover:scale-110 active:scale-95">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-800 dark:text-gray-200" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
        </button>
    </div>

    <!-- Data Logic -->
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('sidebar', () => ({
                searchQuery: '', pages: {{ collections.pages | reverse | json | safe }},
                get filteredPages() {
                    if (this.searchQuery.trim() === '') return this.pages;
                    return this.pages.filter(page => page.title.toLowerCase().includes(this.searchQuery.toLowerCase()));
                }
            }));
        });
    </script>
</body>
</html>
